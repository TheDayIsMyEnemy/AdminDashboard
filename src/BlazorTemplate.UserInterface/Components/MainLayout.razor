@inherits LayoutComponentBase

<MudThemeProvider Theme="@DefaultTheme"
                  @ref="@MudThemeProvider"
                  @bind-IsDarkMode="@IsDarkMode" />

<MudDialogProvider FullWidth="true"
                   MaxWidth="MaxWidth.ExtraSmall"
                   Position="DialogPosition.TopCenter"
                   CloseOnEscapeKey="true"
                   DisableBackdropClick="true" />

<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1">
        <MudIconButton Icon="@Icons.Material.Outlined.Menu"
                       Color="Color.Inherit"
                       Edge="Edge.Start"
                       OnClick="@((e) => DrawerToggle())" />

        <MudSpacer />

        @* <CultureSelector /> *@

        <MudIconButton Icon="@(IsDarkMode ? @Icons.Material.Filled.WbSunny : @Icons.Material.Filled.Brightness4)"
                       Color="Color.Inherit"
                       OnClick="DarkModeToggle" />
        <ProfileMenu />
    </MudAppBar>
    <MudDrawer @bind-Open="IsDrawerOpened" Elevation="1" ClipMode="DrawerClipMode.Never">
        <MudDrawerHeader Class="pt-1 mt-2" Style="height: auto;">
            <svg width="396" height="auto;" viewBox="0 0 350 108.58482491058999" class="css-1j8o68f"><defs id="SvgjsDefs2813"></defs><g id="SvgjsG2814" featurekey="ECw45b-0" transform="matrix(1.296305537223816,0,0,1.296305537223816,110.51806996461744,-36.63986723854755)" fill="#0094fd"><g xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M83.801,42.316c-5.233,0.778-10.119,3.91-14.798,6.208c2.62,3.054,7.524,3.699,11.362,3.652   c3.364-0.041,9.983-0.839,11.686-4.372C94.582,42.55,86.849,41.863,83.801,42.316z"></path><path fill="none" d="M18.879,58.352c2.701,2.911,9.632,3.254,12.971,0.751C27.499,56.234,21.206,55.808,18.879,58.352z"></path><path d="M87.703,39.181c-8.322-1.938-14.974,3.311-22.229,6.114c-4.12,1.592-7.426-2.104-10.669-4.172   c-3.509-2.237-7.172-4.23-10.925-6.026c-7.335-3.511-15.268-6.904-23.537-6.831c-6.149,0.054-12.363,2.902-14.599,9   c-0.439,1.196-1.3,3.626-0.226,4.734c1.178,1.215,2.388,0.408,2.833-0.774c0.539-1.432,0.145-3.063,0.822-4.554   c0.606-1.336,1.578-2.534,2.753-3.413c7.275-5.441,16.673-1.933,23.913,1.344c8.255,3.735,15.786,8.703,23.507,13.4   c-4.668,3.221-10.952,4.853-16.154,7.146c-2.675,1.179-4.925,2.223-7.882,1.624c-2.921-0.592-5.729-1.734-8.667-2.337   c-3.34-0.686-10.835-1.897-9.99,3.981c0.654,4.55,7.873,5.176,11.41,5.011c2.738-0.128,5.18-1.38,7.861-1.623   c2.353-0.213,4.649,1.036,6.693,2.06c4.393,2.199,8.669,4.762,13.283,6.483c4.836,1.804,9.402,1.696,14.372,0.564   c4.043-0.921,2.542-5.262-1.31-4.178c-2.193,0.617-2.481,2.009-5.045,1.828c-2.638-0.186-4.827-0.735-7.266-1.779   c-4.869-2.083-9.626-4.414-14.437-6.624c0.024-2.088,10.291-4.685,12.231-5.378c4.147-1.482,8.741-4.091,13.138-2.562   c4.144,1.441,7.876,3.462,12.384,3.469c4.125,0.007,8.582-0.78,12.023-3.182C98.212,48.16,93.797,40.6,87.703,39.181z    M18.879,58.352c2.326-2.543,8.62-2.117,12.971,0.751C28.511,61.606,21.581,61.263,18.879,58.352z M92.05,47.804   c-1.703,3.534-8.321,4.331-11.686,4.372c-3.838,0.047-8.742-0.598-11.362-3.652c4.68-2.299,9.566-5.431,14.798-6.208   C86.849,41.863,94.582,42.55,92.05,47.804z"></path></g></g><g id="SvgjsG2815" featurekey="6sJQsk-0" transform="matrix(1.540574312210083,0,0,1.540574312210083,-1.0167784370138397,77.77333519550315)" fill="#199dfb"><path d="M13.9 20 l-2.24 0 l-1.38 -3.66 l-6 0 l-1.38 3.66 l-2.24 0 l2.32 -6.2 l-1.02 -1.08 l1.78 -0.92 l2.42 -6.46 l2.24 0 z M9.48 14.2 l-2.2 -6 l-2.2 6 l4.4 0 z M28.932000000000002 17.54 l-2.74 2.44 l-7.64 0 l0 -6.2 l-1.22 -1.08 l1.22 -1.06 l0 -6.3 l7.64 0 l2.74 2.44 l0 9.76 z M26.812 16.54 l0 -7.74 l-1.54 -1.32 l-4.56 0 l0 10.36 l4.56 0 z M48.404 12.719999999999999 l-1.22 1.06 l0 6.22 l-2.14 0 l0 -10.86 l-3.56 6.7 l-2.24 0 l-3.56 -6.7 l0 10.86 l-2.14 0 l0 -6.22 l-1.22 -1.06 l1.22 -1.08 l0 -6.3 l2.34 0 l4.48 8.26 l4.48 -8.26 l2.34 0 l0 6.3 z M56.775999999999996 12.719999999999999 l-1.22 1.08 l0 6.2 l-2.14 0 l0 -6.2 l-1.22 -1.08 l1.22 -1.06 l0 -6.32 l2.14 0 l0 6.32 z M73.928 12.719999999999999 l-1.22 1.06 l0 6.22 l-2.14 0 l-6.12 -10.86 l0 10.86 l-2.14 0 l0 -6.22 l-1.22 -1.06 l1.22 -1.08 l0 -6.3 l2.26 0 l6 10.56 l0 -10.56 l2.14 0 l0 6.3 z M100.212 17.54 l-2.74 2.44 l-7.64 0 l0 -6.2 l-1.22 -1.08 l1.22 -1.06 l0 -6.3 l7.64 0 l2.74 2.44 l0 9.76 z M98.09200000000001 16.54 l0 -7.74 l-1.54 -1.32 l-4.56 0 l0 10.36 l4.56 0 z M116.88400000000001 20 l-2.24 0 l-1.38 -3.66 l-6 0 l-1.38 3.66 l-2.24 0 l2.32 -6.2 l-1.02 -1.08 l1.78 -0.92 l2.42 -6.46 l2.24 0 z M112.46400000000001 14.2 l-2.2 -6 l-2.2 6 l4.4 0 z M131.29600000000002 17.56 l-2.76 2.44 l-4.98 0 l-2.76 -2.44 l0 -2.66 l2.14 0 l0 1.64 l1.52 1.32 l3.16 0 l1.52 -1.32 l0 -1.64 l-1.52 -1.3 l-3.76 0 l-2.76 -2.46 l0 -3.36 l2.76 -2.44 l4.66 0 l2.76 2.44 l0 2.44 l-2.14 0 l0 -1.52 l-1.42 -1.22 l-3.04 0 l-1.42 1.22 l0 1.52 l1.42 1.24 l3.86 0 l2.76 2.44 l0 3.66 z M148.768 12.7 l-1.22 1.08 l0 6.2 l-2.14 0 l0 -6.2 l-6.1 0 l0 6.2 l-2.14 0 l0 -6.2 l-1.22 -1.08 l1.22 -1.06 l0 -6.3 l2.14 0 l0 6.3 l6.1 0 l0 -6.3 l2.14 0 l0 6.3 z M164.12 17.259999999999998 l-2.3 2.74 l-7.32 0 l0 -6.22 l-1.22 -1.06 l1.22 -1.06 l0 -6.32 l7.1 0 l2.38 2.76 l0 2.94 l-1.36 1.56 l1.5 1.6 l0 3.06 z M161.84 10.12 l0 -1.12 l-1.26 -1.54 l-3.94 0 l0 4.18 l3.94 0 z M161.98000000000002 16.34 l0 -1.22 l-1.18 -1.3 l-4.16 0 l0 4.06 l4.16 0 z M181.21200000000002 12.719999999999999 l-1.22 1.06 l0 3.78 l-2.74 2.44 l-5.2 0 l-2.76 -2.44 l0 -3.78 l-1.22 -1.06 l1.22 -1.08 l0 -3.86 l2.76 -2.44 l5.2 0 l2.74 2.44 l0 3.86 z M177.85200000000003 16.56 l0 -7.76 l-1.52 -1.32 l-3.36 0 l-1.52 1.32 l0 7.76 l1.52 1.3 l3.36 0 z M197.68400000000003 20 l-2.24 0 l-1.38 -3.66 l-6 0 l-1.38 3.66 l-2.24 0 l2.32 -6.2 l-1.02 -1.08 l1.78 -0.92 l2.42 -6.46 l2.24 0 z M193.264 14.2 l-2.2 -6 l-2.2 6 l4.4 0 z M212.436 20 l-2.32 0 l-3.06 -6.2 l-2.62 0 l0 6.2 l-2.14 0 l0 -6.2 l-1.22 -1.08 l1.22 -1.06 l0 -6.32 l7.08 0 l2.38 2.76 l0 2.94 l-2.38 2.76 z M209.616 10.12 l0 -1.12 l-1.26 -1.5 l-3.92 0 l0 4.16 l3.92 0 z M227.848 17.54 l-2.74 2.44 l-7.64 0 l0 -6.2 l-1.22 -1.08 l1.22 -1.06 l0 -6.3 l7.64 0 l2.74 2.44 l0 9.76 z M225.728 16.54 l0 -7.74 l-1.54 -1.32 l-4.56 0 l0 10.36 l4.56 0 z"></path></g></svg>
        </MudDrawerHeader>
        <NavMenu />
    </MudDrawer>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.ExtraExtraLarge" Class="my-4 h-100">
            @* <ErrorHandler MaximumErrorCount="2"> *@
                @Body
            @* </ErrorHandler> *@
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private MudThemeProvider? MudThemeProvider { get; set; }
    private DefaultTheme DefaultTheme { get; set; } = new();
    private bool IsDrawerOpened { get; set; } = true;
    private bool IsDarkMode { get; set; }

    private void DrawerToggle() => IsDrawerOpened = !IsDrawerOpened;

    private void DarkModeToggle() => IsDarkMode = !IsDarkMode;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            IsDarkMode = await MudThemeProvider!.GetSystemPreference();
            StateHasChanged();
        }
    }
}